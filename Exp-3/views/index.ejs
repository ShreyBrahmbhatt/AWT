<!DOCTYPE html>
<html>
<head>
  <title>Advanced Task Manager</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>

<div class="dashboard">
  <h1>Task Manager Dashboard</h1>

  <!-- ADD TASK -->
  <form class="add-form" action="/tasks" method="POST">
    <input type="text" name="name" placeholder="Add new task..." required>
    <button>Add</button>
  </form>

  <!-- TASK TABLE -->
  <table>
    <thead>
      <tr>
        <th>Task</th>
        <th>Status</th>
        <th>Last Updated</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <% tasks.forEach(task => { %>
        <tr class="<%= task.completed ? 'done' : '' %>">

          <!-- TASK NAME -->
          <td>
            <form action="/tasks/<%= task._id %>?_method=PUT" method="POST">
              <input type="text" name="name" value="<%= task.name %>" required>
              <button class="save">ğŸ’¾</button>
            </form>
          </td>

          <!-- STATUS -->
          <td>
            <form action="/tasks/<%= task._id %>/toggle?_method=PUT" method="POST">
              <button class="status">
                <%= task.completed ? "Completed" : "Pending" %>
              </button>
            </form>
          </td>

          <!-- LAST UPDATED (SAFE) -->
          <td>
            <%= task.updatedAt ? task.updatedAt.toLocaleString() : "N/A" %>
          </td>

          <!-- DELETE -->
          <td>
            <form action="/tasks/<%= task._id %>?_method=DELETE" method="POST">
              <button class="delete">ğŸ—‘</button>
            </form>
          </td>

        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

</body>
</html>